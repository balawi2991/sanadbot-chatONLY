# 🤖 SanadBot - نظام الدردشة الذكي

نظام دردشة ذكي متطور يدعم الذكاء الاصطناعي والأسئلة والأجوبة المخصصة، مصمم خصيصاً للمواقع العربية.

## ✨ المميزات الرئيسية

### 🧠 ذكاء اصطناعي متقدم
- **تكامل مع Gemini AI**: استخدام أحدث نماذج Google للذكاء الاصطناعي
- **تقنية RAG**: دمج مصادر المعرفة مع الذكاء الاصطناعي للحصول على إجابات دقيقة
- **بحث ذكي في Q&A**: نظام بحث متطور يجد الإجابات المناسبة

### 📚 إدارة المعرفة
- **مصادر متنوعة**: دعم النصوص، الروابط، والملفات
- **Q&A مخصصة**: إضافة أسئلة وأجوبة يدوية
- **أولوية الإجابات**: Q&A أولاً، ثم RAG، ثم الرد الاحتياطي

### 🎨 تخصيص كامل
- **مظهر قابل للتخصيص**: ألوان، شعارات، وصور رمزية
- **شخصية البوت**: تحديد طريقة التفاعل والرد
- **معاينة مباشرة**: رؤية التغييرات فوراً

### 🔒 أمان وخصوصية
- **عزل البيانات**: كل مستخدم له بياناته المنفصلة
- **مصادقة آمنة**: نظام تسجيل دخول محمي
- **حفظ المحادثات**: تسجيل آمن لجميع التفاعلات

## 🚀 التقنيات المستخدمة

- **Frontend**: Next.js 15, React, TypeScript, Tailwind CSS
- **Backend**: Next.js API Routes, Prisma ORM
- **Database**: PostgreSQL
- **AI**: Google Gemini AI
- **Authentication**: NextAuth.js

## 📦 التثبيت والتشغيل

### المتطلبات الأساسية
- **Node.js**: الإصدار 18 أو أحدث
- **npm**: مدير الحزم (يأتي مع Node.js)
- **مفتاح Gemini AI**: من Google AI Studio
- **قاعدة بيانات**: SQLite (افتراضي) أو PostgreSQL

### 🔧 خطوات التثبيت التفصيلية

#### 1. تحميل المشروع
```bash
git clone <repository-url>
cd sanad-bot
```

#### 2. تثبيت التبعيات
```bash
npm install
```

#### 3. إعداد متغيرات البيئة
قم بإنشاء ملف `.env.local` في المجلد الجذر وإضافة:

```env
# قاعدة البيانات (SQLite - للتطوير)
DATABASE_URL="file:./dev.db"

# أو PostgreSQL (للإنتاج)
# DATABASE_URL="postgresql://username:password@localhost:5432/sanadbot"

# إعدادات المصادقة
NEXTAUTH_URL="http://localhost:3002"
NEXTAUTH_SECRET="your-very-secure-secret-key-here"

# مفتاح Gemini AI (مطلوب)
GEMINI_API_KEY="your-gemini-api-key-from-google-ai-studio"
```

#### 4. الحصول على مفتاح Gemini AI
1. اذهب إلى [Google AI Studio](https://aistudio.google.com/)
2. قم بإنشاء حساب أو تسجيل الدخول
3. انشئ مفتاح API جديد
4. انسخ المفتاح وضعه في متغير `GEMINI_API_KEY`

#### 5. إعداد قاعدة البيانات
```bash
# إنشاء وتطبيق الهجرات
npx prisma migrate dev --name init

# توليد عميل Prisma
npx prisma generate
```

#### 6. إضافة بيانات تجريبية (اختياري)
```bash
# إضافة مستخدم تجريبي وبيانات أساسية
npx tsx scripts/seed-demo.ts

# أو إضافة مستخدم اختبار فقط
npx tsx scripts/seed-test-user.ts
```

#### 7. تشغيل التطبيق
```bash
npm run dev
```

✅ **التطبيق جاهز!** افتح [http://localhost:3002](http://localhost:3002) في المتصفح.

### 🔐 بيانات الدخول التجريبية
بعد تشغيل `seed-demo.ts`:
- **البريد الإلكتروني**: `demo@sanad.ai`
- **كلمة المرور**: `123456`

## 🧪 اختبار المساعد الذكي

يمكنك اختبار المساعد الذكي من خلال:

1. **الصفحة الرئيسية**: `http://localhost:3002`
2. **صفحة الاختبار المتقدمة**: `http://localhost:3002/test`

### أسئلة للاختبار

**أسئلة Q&A (إجابات محفوظة)**:
- ما هو سند؟
- كيف يعمل المساعد الذكي؟
- هل يمكنني تخصيص المساعد؟

**أسئلة RAG (من مصادر المعرفة)**:
- متى تأسست شركة سند؟
- ما هي خدمات الشركة؟
- أخبرني عن الشركة

## 🔄 آلية عمل المساعد الذكي

1. **استقبال السؤال**: المستخدم يرسل سؤال
2. **البحث في Q&A**: البحث عن إجابة محفوظة مسبقاً
3. **تفعيل RAG**: إذا لم توجد إجابة، استخدام مصادر المعرفة مع Gemini AI
4. **الرد الاحتياطي**: رسالة افتراضية إذا لم تتوفر معلومات
5. **حفظ المحادثة**: تسجيل السؤال والجواب في قاعدة البيانات

## 📁 هيكل المشروع

```
sanad-bot/
├── prisma/
│   ├── schema.prisma      # نموذج قاعدة البيانات
│   └── migrations/        # هجرات قاعدة البيانات
├── scripts/
│   ├── seed-demo.ts       # بيانات تجريبية
│   └── seed-test-user.ts  # مستخدم اختبار
├── src/
│   ├── app/
│   │   ├── api/
│   │   │   ├── auth/       # مصادقة المستخدمين
│   │   │   ├── bot/        # إدارة البوت
│   │   │   ├── chat/       # API المحادثة الذكية
│   │   │   ├── qas/        # الأسئلة والأجوبة
│   │   │   └── knowledge-sources/ # مصادر المعرفة
│   │   ├── auth/
│   │   │   ├── signin/     # صفحة تسجيل الدخول
│   │   │   └── signup/     # صفحة التسجيل
│   │   ├── dashboard/
│   │   │   ├── appearance/ # تخصيص المظهر
│   │   │   ├── qa/         # إدارة Q&A
│   │   │   └── training-materials/ # مصادر المعرفة
│   │   └── test/[botId]/   # صفحة اختبار المساعد
│   ├── components/
│   │   ├── ChatWidget/     # مكون المحادثة
│   │   ├── Sidebar.tsx     # الشريط الجانبي
│   │   └── SessionProvider.tsx # مزود الجلسة
│   └── lib/
│       └── prisma.ts       # إعداد قاعدة البيانات
├── .env.local             # متغيرات البيئة
├── package.json           # التبعيات والسكريبتات
└── README.md             # هذا الملف
```

## 🛠️ التطوير والصيانة

### إدارة قاعدة البيانات

#### عرض البيانات
```bash
# فتح Prisma Studio لعرض وتعديل البيانات
npx prisma studio
```

#### إعادة تعيين قاعدة البيانات
```bash
# حذف قاعدة البيانات وإعادة إنشائها
npx prisma migrate reset

# إضافة البيانات التجريبية مرة أخرى
npx tsx scripts/seed-demo.ts
```

#### إنشاء هجرة جديدة
```bash
# بعد تعديل schema.prisma
npx prisma migrate dev --name describe-your-changes
```

### السكريبتات المتاحة

```bash
# تشغيل التطبيق في وضع التطوير
npm run dev

# بناء التطبيق للإنتاج
npm run build

# تشغيل التطبيق في وضع الإنتاج
npm start

# فحص الكود
npm run lint
```

### 🔧 استكشاف الأخطاء

#### مشاكل شائعة وحلولها

**خطأ في الاتصال بقاعدة البيانات:**
```bash
# تأكد من صحة DATABASE_URL في .env.local
# ثم قم بتوليد العميل مرة أخرى
npx prisma generate
```

**خطأ في مفتاح Gemini:**
- تأكد من صحة `GEMINI_API_KEY` في `.env.local`
- تحقق من أن المفتاح نشط في Google AI Studio

**مشاكل في التبعيات:**
```bash
# حذف node_modules وإعادة التثبيت
rm -rf node_modules package-lock.json
npm install
```

### 📊 نموذج قاعدة البيانات

- **User**: معلومات المستخدمين
- **Bot**: إعدادات المساعد الذكي لكل مستخدم
- **KnowledgeSource**: مصادر المعرفة (نصوص، روابط، ملفات)
- **QA**: الأسئلة والأجوبة المحفوظة
- **Conversation**: سجل المحادثات

### 🚀 النشر

#### متطلبات الإنتاج
1. قاعدة بيانات PostgreSQL
2. متغيرات البيئة المناسبة
3. مفتاح Gemini AI صالح

#### إعداد متغيرات الإنتاج
```env
DATABASE_URL="postgresql://user:password@host:port/database"
NEXTAUTH_URL="https://yourdomain.com"
NEXTAUTH_SECRET="very-secure-production-secret"
GEMINI_API_KEY="your-production-gemini-key"
```

## 🎯 الميزات المتقدمة

### 🔍 نظام البحث الذكي
- **أولوية الإجابات**: Q&A → RAG → رد احتياطي
- **بحث دلالي**: استخدام تقنيات الذكاء الاصطناعي للبحث
- **تحسين النتائج**: تعلم من التفاعلات السابقة

### 🎨 التخصيص المتقدم
- **ألوان ديناميكية**: تخصيص كامل للواجهة
- **شخصية البوت**: تحديد أسلوب الرد والتفاعل
- **معاينة فورية**: رؤية التغييرات مباشرة

### 📈 التحليلات والإحصائيات
- **عدد المحادثات**: تتبع التفاعلات
- **مصادر المعرفة**: إحصائيات الاستخدام
- **أداء Q&A**: معدلات النجاح

## 🔒 الأمان والخصوصية

### حماية البيانات
- **عزل كامل**: كل مستخدم له بياناته المنفصلة
- **تشفير كلمات المرور**: استخدام bcrypt
- **جلسات آمنة**: NextAuth.js مع JWT

### أفضل الممارسات
- **التحقق من المدخلات**: تنظيف وتحقق من جميع البيانات
- **حدود الاستخدام**: منع إساءة الاستخدام
- **تسجيل العمليات**: تتبع الأنشطة المهمة

## 🤝 المساهمة في المشروع

### كيفية المساهمة
1. **Fork** المشروع
2. إنشاء فرع جديد (`git checkout -b feature/amazing-feature`)
3. تنفيذ التغييرات (`git commit -m 'Add amazing feature'`)
4. رفع التغييرات (`git push origin feature/amazing-feature`)
5. إنشاء **Pull Request**

### إرشادات التطوير
- اتبع معايير الكود الموجودة
- أضف تعليقات واضحة
- اختبر التغييرات قبل الرفع
- حدث التوثيق عند الحاجة

## 📞 الدعم والمساعدة

### الحصول على المساعدة
- **Issues**: لتقرير الأخطاء أو طلب ميزات جديدة
- **Discussions**: للأسئلة والنقاشات العامة
- **Wiki**: للتوثيق التفصيلي

### الأسئلة الشائعة

**س: كيف أغير قاعدة البيانات من SQLite إلى PostgreSQL؟**
ج: غيّر `DATABASE_URL` في `.env.local` ثم شغّل `npx prisma migrate deploy`

**س: هل يمكنني استخدام مفاتيح AI أخرى غير Gemini؟**
ج: حالياً المشروع يدعم Gemini فقط، لكن يمكن إضافة دعم لمفاتيح أخرى

**س: كيف أضيف لغات جديدة؟**
ج: يمكن تعديل ملفات الترجمة وإضافة دعم i18n

---

## 📄 الترخيص

هذا المشروع مرخص تحت رخصة MIT - راجع ملف [LICENSE](LICENSE) للتفاصيل.

---

**تم تطويره بـ ❤️ باستخدام أحدث التقنيات**

*سند - المساعد الذكي الذي يفهمك ويتعلم منك*
